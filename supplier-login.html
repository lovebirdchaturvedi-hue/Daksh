<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Supplier Login</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="Cache-Control" content="no-store">

<style>
body{font-family:Arial;background:#071427;color:#fff;display:flex;justify-content:center;align-items:center;height:100vh}
.box{background:#fff;color:#000;padding:30px;border-radius:10px;width:320px}
input,button{width:100%;padding:12px;margin-top:10px}
button{background:#2563eb;color:#fff;border:none}
.error{color:red;font-size:13px;margin-top:8px}
</style>
</head>
<body>

<div class="box">
  <h3>Login</h3>
  <input id="email" placeholder="Email">
  <input id="password" type="password" placeholder="Password">
  <button id="loginBtn" type="button">Login</button>
  <div class="error" id="msg"></div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getAuth, signInWithEmailAndPassword, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const app = initializeApp({
  apiKey: "AIzaSyABA-KRY6bY7K2QZwLhQ2piHjQVLLceiGs",
  authDomain: "apd-globaltrade-prod.firebaseapp.com",
  projectId: "apd-globaltrade-prod"
});

const auth = getAuth(app);
const db = getFirestore(app);

document.getElementById("loginBtn").onclick = async () => {
  document.getElementById("msg").textContent = "";
  try {
    await signInWithEmailAndPassword(
      auth,
      email.value.trim(),
      password.value.trim()
    );
  } catch (e) {
    document.getElementById("msg").textContent = e.message;
  }
};

onAuthStateChanged(auth, async (user) => {
  if (!user) return;

  const adminSnap = await getDoc(doc(db, "admin", user.uid));
  if (adminSnap.exists()) {
    location.href = "/admin.html";
  } else {
    location.href = "/supplier-dashboard.html";
  }
});
</script>

</body>
</html>
